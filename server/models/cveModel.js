const mongoose = require("mongoose");
const Schema = mongoose.Schema;

const CvssV2Schema = new Schema({
  cvssData:{
  vectorString: String,
  accessVector: String,
  accessComplexity: String,
  authentication: String,
  confidentialityImpact: String,
  integrityImpact: String,
  availabilityImpact: String,
  baseScore: Number,
  baseSeverity: String,
  exploitabilityScore: Number,
  impactScore: Number
  }
});


const CveSchema = new Schema({
  id: { type: String, required: true, unique: true },
  publishedDate: { type: Date, required: true },
  lastModifiedDate: { type: Date, required: true },
  description: { type: String, required: true },
  vulnStatus: { type: String, required: true },
  sourceIdentifier: { type: String, required: true },
  metrics:{
    cvssV2: { type: CvssV2Schema },
  },
  configurations: Array, 
});


CveSchema.index({ publishedDate: 1 });
CveSchema.index({ lastModifiedDate: 1 });
CveSchema.index({ 'metrics.cvssV2.cvssData.baseScore': 1 });

module.exports = mongoose.model("CVE", CveSchema);
