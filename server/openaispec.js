const openApiSpec = {
  openapi: "3.0.0",
  info: {
    title: "CVE API",
    version: "1.0.0",
    description:
      "The CVE API provides a set of endpoints to manage Common Vulnerabilities and Exposures (CVEs). It allows users to retrieve information about CVEs, including their descriptions, publication dates, modification dates, configurations, source identifiers, vulnerability statuses, and metrics. The API supports pagination for fetching large sets of CVEs and allows filtering CVEs based on various criteria such as publication year, CVSS score, and modification date.",
  },
  servers: [
    {
      url: "http://localhost:8080/api",
    },
  ],
  paths: {
    "/cves": {
      get: {
        summary: "Get paginated CVEs",
        description:
          "This endpoint retrieves a paginated list of CVEs. Users can specify the page number and the number of items per page using query parameters.",
        parameters: [
          {
            name: "page",
            in: "query",
            description: "Page number",
            required: false,
            schema: {
              type: "integer",
              minimum: 1,
            },
          },
          {
            name: "limit",
            in: "query",
            description: "Number of items per page",
            required: false,
            schema: {
              type: "integer",
              minimum: 1,
            },
          },
        ],
        responses: {
          200: {
            description: "Successful response",
            content: {
              "application/json": {
                schema: {
                  $ref: "#/components/schemas/CveList",
                },
              },
            },
          },
          500: {
            description: "Internal server error",
          },
        },
      },
    },
    "/cves/{cveId}": {
      get: {
        summary: "Get CVE by ID",
        description:
          "This endpoint retrieves a CVE by its ID. You need to provide the ID of the CVE in the path parameter.",
        parameters: [
          {
            name: "cveId",
            in: "path",
            description: "ID of the CVE",
            required: true,
            schema: {
              type: "string",
            },
          },
        ],
        responses: {
          200: {
            description: "Successful response",
            content: {
              "application/json": {
                schema: {
                  $ref: "#/components/schemas/Cve",
                },
              },
            },
          },
          404: {
            description: "CVE not found",
          },
          500: {
            description: "Internal server error",
          },
        },
      },
    },
    "/cves/year/{year}": {
      get: {
        summary: "Get CVEs by year",
        description:
          "This endpoint facilitates the retrieval of CVE details based on the CVE IDs belonging to a specific year. Users can provide the year as a 4-digit string to filter CVEs accordingly.",
        parameters: [
          {
            name: "year",
            in: "path",
            description: "Year to filter CVEs",
            required: true,
            schema: {
              type: "string",
              pattern: "^\\d{4}$",
            },
          },
        ],
        responses: {
          200: {
            description: "Successful response",
            content: {
              "application/json": {
                schema: {
                  $ref: "#/components/schemas/CveList",
                },
              },
            },
          },
          400: {
            description: "Invalid year format",
          },
          500: {
            description: "Internal server error",
          },
        },
      },
    },
    "/cves/score/{score}": {
      get: {
        summary: "Get CVEs by score",
        description:
          "This endpoint retrieves CVEs with a specific CVSS score. You need to provide the CVSS score as a number between 0 and 10 in the path parameter.",
        parameters: [
          {
            name: "score",
            in: "path",
            description: "CVSS score to filter CVEs",
            required: true,
            schema: {
              type: "number",
              minimum: 0,
              maximum: 10,
            },
          },
        ],
        responses: {
          200: {
            description: "Successful response",
            content: {
              "application/json": {
                schema: {
                  $ref: "#/components/schemas/CveList",
                },
              },
            },
          },
          400: {
            description: "Invalid CVSS score",
          },
          500: {
            description: "Internal server error",
          },
        },
      },
    },
    "/cves/modified/{days}": {
      get: {
        summary: "Get CVEs modified in last N days",
        description:
          "This endpoint retrieves CVEs modified in the last N days. You need to provide the number of days as an integer in the path parameter.",
        parameters: [
          {
            name: "days",
            in: "path",
            description: "Number of days to filter CVEs",
            required: true,
            schema: {
              type: "integer",
              minimum: 1,
            },
          },
        ],
        responses: {
          200: {
            description: "Successful response",
            content: {
              "application/json": {
                schema: {
                  $ref: "#/components/schemas/CveList",
                },
              },
            },
          },
          400: {
            description: "Invalid number of days",
          },
          500: {
            description: "Internal server error",
          },
        },
      },
    },
    "/totalcves": {
      get: {
        summary: "Get total number of CVEs",
        description:
          "This endpoint retrieves the total number of CVEs in the database.",
        responses: {
          200: {
            description: "Successful response",
            content: {
              "application/json": {
                schema: {
                  $ref: "#/components/schemas/TotalCves",
                },
              },
            },
          },
          500: {
            description: "Internal server error",
          },
        },
      },
    },
  },
  components: {
    schemas: {
      Cve: {
        type: "object",
        properties: {
          id: {
            type: "string",
          },
          description: {
            type: "string",
          },
          publishedDate: {
            type: "string",
            format: "date-time",
          },
          lastModifiedDate: {
            type: "string",
            format: "date-time",
          },
          configurations: {
            type: "array",
            items: {},
          },
          sourceIdentifier: {
            type: "string",
          },
          vulnStatus: {
            type: "string",
          },
          metrics: {
            type: "object",
          },
        },
      },
      CveList: {
        type: "array",
        items: {
          $ref: "#/components/schemas/Cve",
        },
      },
      TotalCves: {
        type: "object",
        properties: {
          totalCves: {
            type: "integer",
          },
        },
      },
    },
  },
};

module.exports = openApiSpec;
